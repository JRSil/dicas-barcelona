"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}var _extends=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};!function(){function n(i){function o(t){t.parentElement.removeChild(t)}function r(t,n,e){var i=0===e?t.children[0]:t.children[e-1].nextSibling;t.insertBefore(n,i)}function s(t,n){var e=this;this.$nextTick(function(){return e.$emit(t.toLowerCase(),n)})}var a=["Start","Add","Remove","Update","End"],l=["Choose","Sort","Filter","Clone"],e=["Move"].concat(a,l).map(function(t){return"on"+t}),u=null;return{name:"draggable",props:{options:Object,list:{type:Array,required:!1,default:null},value:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:function(t){return t}},element:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},data:function(){return{transitionMode:!1,noneFunctionalComponentMode:!1,init:!1}},render:function(t){var n=this.$slots.default;if(n&&1===n.length){var e=n[0];e.componentOptions&&"transition-group"===e.componentOptions.tag&&(this.transitionMode=!0)}var i=n,o=this.$slots.footer;o&&(i=n?[].concat(_toConsumableArray(n),_toConsumableArray(o)):[].concat(_toConsumableArray(o)));var r=null,s=function(t,n){var e,i,o;e=r,i=t,null==(o=n)||((e=null==e?{}:e)[i]=o),r=e};if(s("attrs",this.$attrs),this.componentData){var a=this.componentData,l=a.on,u=a.props;s("on",l),s("props",u)}return t(this.element,r,i)},mounted:function(){var e=this;if(this.noneFunctionalComponentMode=this.element.toLowerCase()!==this.$el.nodeName.toLowerCase(),this.noneFunctionalComponentMode&&this.transitionMode)throw new Error("Transition-group inside component is not supported. Please alter element value or remove transition-group. Current element value: "+this.element);var n={};a.forEach(function(t){n["on"+t]=function(n){var e=this;return function(t){null!==e.realList&&e["onDrag"+n](t),s.call(e,n,t)}}.call(e,t)}),l.forEach(function(t){n["on"+t]=s.bind(e,t)});var t=_extends({},this.options,n,{onMove:function(t,n){return e.onDragMove(t,n)}});!("draggable"in t)&&(t.draggable=">*"),this._sortable=new i(this.rootContainer,t),this.computeIndexes()},beforeDestroy:function(){this._sortable.destroy()},computed:{rootContainer:function(){return this.transitionMode?this.$el.children[0]:this.$el},isCloning:function(){return!!this.options&&!!this.options.group&&"clone"===this.options.group.pull},realList:function(){return this.list?this.list:this.value}},watch:{options:{handler:function(t){for(var n in t)-1==e.indexOf(n)&&this._sortable.option(n,t[n])},deep:!0},realList:function(){this.computeIndexes()}},methods:{getChildrenNodes:function(){if(this.init||(this.noneFunctionalComponentMode=this.noneFunctionalComponentMode&&1==this.$children.length,this.init=!0),this.noneFunctionalComponentMode)return this.$children[0].$slots.default;var t=this.$slots.default;return this.transitionMode?t[0].child.$slots.default:t},computeIndexes:function(){var t=this;this.$nextTick(function(){t.visibleIndexes=function(t,n,e){if(!t)return[];var i=t.map(function(t){return t.elm}),o=[].concat(_toConsumableArray(n)).map(function(t){return i.indexOf(t)});return e?o.filter(function(t){return-1!==t}):o}(t.getChildrenNodes(),t.rootContainer.children,t.transitionMode)})},getUnderlyingVm:function(t){var n,e,i=(n=this.getChildrenNodes()||[],e=t,n.map(function(t){return t.elm}).indexOf(e));return-1===i?null:{index:i,element:this.realList[i]}},getUnderlyingPotencialDraggableComponent:function(t){var n=t.__vue__;return n&&n.$options&&"transition-group"===n.$options._componentTag?n.$parent:n},emitChanges:function(t){var n=this;this.$nextTick(function(){n.$emit("change",t)})},alterList:function(t){if(this.list)t(this.list);else{var n=[].concat(_toConsumableArray(this.value));t(n),this.$emit("input",n)}},spliceList:function(){var n=arguments,t=function(t){return t.splice.apply(t,n)};this.alterList(t)},updatePosition:function(n,e){var t=function(t){return t.splice(e,0,t.splice(n,1)[0])};this.alterList(t)},getRelatedContextFromMoveEvent:function(t){var n=t.to,e=t.related,i=this.getUnderlyingPotencialDraggableComponent(n);if(!i)return{component:i};var o=i.realList,r={list:o,component:i};if(n!==e&&o&&i.getUnderlyingVm){var s=i.getUnderlyingVm(e);if(s)return _extends(s,r)}return r},getVmIndex:function(t){var n=this.visibleIndexes,e=n.length;return e-1<t?e:n[t]},getComponent:function(){return this.$slots.default[0].componentInstance},resetTransitionData:function(t){if(this.noTransitionOnDrag&&this.transitionMode){this.getChildrenNodes()[t].data=null;var n=this.getComponent();n.children=[],n.kept=void 0}},onDragStart:function(t){this.context=this.getUnderlyingVm(t.item),t.item._underlying_vm_=this.clone(this.context.element),u=t.item},onDragAdd:function(t){var n=t.item._underlying_vm_;if(void 0!==n){o(t.item);var e=this.getVmIndex(t.newIndex);this.spliceList(e,0,n),this.computeIndexes();var i={element:n,newIndex:e};this.emitChanges({added:i})}},onDragRemove:function(t){if(r(this.rootContainer,t.item,t.oldIndex),this.isCloning)o(t.clone);else{var n=this.context.index;this.spliceList(n,1);var e={element:this.context.element,oldIndex:n};this.resetTransitionData(n),this.emitChanges({removed:e})}},onDragUpdate:function(t){o(t.item),r(t.from,t.item,t.oldIndex);var n=this.context.index,e=this.getVmIndex(t.newIndex);this.updatePosition(n,e);var i={element:this.context.element,oldIndex:n,newIndex:e};this.emitChanges({moved:i})},computeFutureIndex:function(t,n){if(!t.element)return 0;var e=[].concat(_toConsumableArray(n.to.children)).filter(function(t){return"none"!==t.style.display}),i=e.indexOf(n.related),o=t.component.getVmIndex(i);return-1!=e.indexOf(u)||!n.willInsertAfter?o:o+1},onDragMove:function(t,n){var e=this.move;if(!e||!this.realList)return!0;var i=this.getRelatedContextFromMoveEvent(t),o=this.context,r=this.computeFutureIndex(i,t);return _extends(o,{futureIndex:r}),_extends(t,{relatedContext:i,draggedContext:o}),e(t,n)},onDragEnd:function(t){this.computeIndexes(),u=null}}}}if(Array.from||(Array.from=function(t){return[].slice.call(t)}),"object"==typeof exports){var t=require("sortablejs");module.exports=n(t)}else if("function"==typeof define&&define.amd)define(["sortablejs"],function(t){return n(t)});else if(window&&window.Vue&&window.Sortable){var e=n(window.Sortable);Vue.component("draggable",e)}}();