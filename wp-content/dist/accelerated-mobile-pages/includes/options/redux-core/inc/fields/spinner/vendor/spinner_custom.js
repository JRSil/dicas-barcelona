!function(S,t){var M,O="ui-state-active",T="ui-state-hover",e="ui-state-disabled",W=S.ui.keyCode,k=W.UP,N=W.DOWN,B=W.RIGHT,E=W.LEFT,I=W.PAGE_UP,V=W.PAGE_DOWN,D=W.HOME,A=W.END,F=S.browser.msie,c=S.browser.mozilla?"DOMMouseScroll":"mousewheel",L=".uispinner",P=[k,N,B,E,I,V,D,A,W.BACKSPACE,W.DELETE,W.TAB];S.widget("ui.spinner",{options:{min:null,max:null,allowNull:!1,group:"",point:".",prefix:"",suffix:"",places:null,defaultStep:1,largeStep:10,mouseWheel:!0,increment:"slow",className:null,showOn:"always",width:95,upIconClass:"ui-icon-triangle-1-n",downIconClass:"ui-icon-triangle-1-s",format:function(t,e){var n=this,i=/(\d+)(\d{3})/,s=(isNaN(t)?0:Math.abs(t)).toFixed(e)+"";for(s=s.replace(".",n.point);i.test(s)&&n.group;s=s.replace(i,"$1"+n.group+"$2"));return(t<0?"-":"")+n.prefix+s+n.suffix},parse:function(t){var e=this;return"."==e.group&&(t=t.replace(".","")),"."!=e.point&&(t=t.replace(e.point,".")),parseFloat(t.replace(/[^0-9\-\.]/g,""))}},_create:function(){var t=this,e=t.element,n=e.attr("type");!e.is("input")||"text"!=n&&"number"!=n?console.error("Invalid target for ui.spinner"):(t._procOptions(!0),t._createButtons(e),e.is(":enabled")||t.disable())},_createButtons:function(t){function e(){return d&&(S(this).removeClass(O),f._stopSpin(),d=!1),!1}function n(t){if(s){if(t===u)return;clearTimeout(s)}u=t,s=setTimeout(function(){s=0,t()},100)}function o(t){for(var e=0;e<P.length;e++)if(P[e]==t)return!0;return!1}var a,r,i,s,u,l,c,p,d,h,f=this,m=f.options,g=m.className,v=m.width,b=m.showOn,_=S.support.boxModel,w=t.outerHeight(),C=(f.oMargin="auto"==(h=t.css("margin-right"))?0:parseInt(h),f.wrapper=t.wrap('<span class="spinner-wrpr" />').css({width:(f.oWidth=_?t.width():t.outerWidth())-v,marginRight:"30px",marginLeft:"30px",textAlign:"center",float:"none",marginTop:0}).after('<span class="ui-spinner ui-widget"></span>').next()),y=f.btnContainer=S('<div class="ui-spinner-buttons"><div class="ui-spinner-up ui-spinner-button ui-state-default ui-corner-tr"><span class="ui-icon '+m.upIconClass+'"> </span></div><div class="ui-spinner-down ui-spinner-button ui-state-default ui-corner-br"><span class="ui-icon '+m.downIconClass+'"> </span></div></div>'),x="rtl"==t[0].dir;g&&C.addClass(g),C.append(y.css({height:w,left:0,top:0})),(i=f.buttons=y.find(".ui-spinner-button")).css({width:"30px",height:w-(_?i.outerHeight()-i.height():0)}),i.eq(0).css({right:"0"}),i.eq(1).css({left:"0"}),a=i[0],r=i[1],i.find(".ui-icon"),y.width("105px"),"always"!=b&&y.css("opacity",0),"hover"!=b&&"both"!=b||i.add(t).bind("mouseenter"+L,function(){n(function(){l=!0,f.focused&&"hover"!=b||f.showButtons()})}).bind("mouseleave"+L,function(){n(function(){l=!1,f.focused&&"hover"!=b||f.hideButtons()})}),i.hover(function(){f.buttons.removeClass(T),m.disabled||S(this).addClass(T)},function(){S(this).removeClass(T)}).mousedown(function(){if(!m.disabled){var t=f.element[0],e=this===a?1:-1;t.focus(),t.select(),S(this).addClass(O),d=!0,f._startSpin(e)}return!1}).mouseup(e).mouseout(e),F&&i.dblclick(function(){return m.disabled||(f._change(),f._doSpin((this===a?1:-1)*m.step)),!1}).bind("selectstart",function(){return!1}),t.bind("keydown"+L,function(t){var e,n,i,s=t.keyCode;if(t.ctrl||t.alt)return!0;if(o(s)&&(p=!0),c)return!1;switch(s){case k:case I:e=1,n=s==I;break;case N:case V:e=-1,n=s==V;break;case B:case E:e=s==B^x?1:-1;break;case D:return null!=(i=f.options.min)&&f._setValue(i),!1;case A:return i=f.options.max,null!=(i=f.options.max)&&f._setValue(i),!1}return e?(c||m.disabled||(keyDir=e,S(0<e?a:r).addClass(O),c=!0,f._startSpin(e,n)),!1):void 0}).bind("keyup"+L,function(t){if(t.ctrl||t.alt)return!0;switch(o(W)&&(p=!1),t.keyCode){case k:case B:case I:case N:case E:case V:return i.removeClass(O),f._stopSpin(),c=!1}}).bind("keypress"+L,function(t){if(function(t,e){if(p)return!1;var n=String.fromCharCode(e||t),i=f.options;return!("0"<=n&&n<="9"||"-"==n||0<f.places&&n==i.point||n==i.group)}(t.keyCode,t.charCode))return!1}).bind("change"+L,function(){f._change()}).bind("focus"+L,function(){function t(){f.element.select()}F?t():setTimeout(t,0),f.focused=!0,M=f,l||"focus"!=b&&"both"!=b||f.showButtons()}).bind("blur"+L,function(){f.focused=!1,l||"focus"!=b&&"both"!=b||f.hideButtons()})},_procOptions:function(t){var e,n=this,i=n.element,s=n.options,o=s.min,a=s.max,r=s.step,u=s.places,l=-1;"slow"==s.increment?s.increment=[{count:1,mult:1,delay:250},{count:3,mult:1,delay:100},{count:0,mult:1,delay:50}]:"fast"==s.increment&&(s.increment=[{count:1,mult:1,delay:250},{count:19,mult:1,delay:100},{count:80,mult:1,delay:20},{count:100,mult:10,delay:20},{count:0,mult:100,delay:20}]),null==o&&null!=(e=i.attr("min"))&&(o=parseFloat(e)),null==a&&null!=(e=i.attr("max"))&&(a=parseFloat(e)),r||null==(e=i.attr("step"))||"any"!=e&&(r=parseFloat(e),s.largeStep*=r),s.step=r=r||s.defaultStep,null==u&&-1!=(e=r+"").indexOf(".")&&(u=e.length-e.indexOf(".")-1),n.places=u,null!=a&&null!=o&&(a<o&&(o=a),l=Math.max(Math.max(l,s.format(a,u,i).length),s.format(o,u,i).length)),t&&(n.inputMaxLength=i[0].maxLength),0<(e=n.inputMaxLength)&&(l=0<l?Math.min(e,l):e,e=Math.pow(10,l)-1,(null==a||e<a)&&(a=e),e=-(e+1)/10+1,(null==o||o<e)&&(o=e)),0<l&&i.attr("maxlength",l),s.min=o,s.max=a,n._change(),i.unbind(c+L),s.mouseWheel&&i.bind(c+L,n._mouseWheel)},_mouseWheel:function(t){var e=S.data(this,"spinner");if(!e.options.disabled&&e.focused&&M===e)return e._change(),e._doSpin((0<(t.wheelDelta||-t.detail)?1:-1)*e.options.step),!1},_setTimer:function(t,e,n){var i=this;i._stopSpin(),i.timer=setInterval(function(){i._spin(e,n)},t)},_stopSpin:function(){this.timer&&(clearInterval(this.timer),this.timer=0)},_startSpin:function(t,e){var n=this,i=n.options.increment;n._change(),n._doSpin(t*(e?n.options.largeStep:n.options.step)),i&&0<i.length&&(n.counter=0,n.incCounter=0,n._setTimer(i[0].delay,t,e))},_spin:function(t,e){var n=this,i=n.options.increment,s=i[n.incCounter];n._doSpin(t*s.mult*(e?n.options.largeStep:n.options.step)),n.counter++,n.counter>s.count&&n.incCounter<i.length-1&&(n.counter=0,s=i[++n.incCounter],n._setTimer(s.delay,t,e))},_doSpin:function(t){var e=this.curvalue;null==e&&(e=(0<t?this.options.min:this.options.max)||0),this._setValue(e+t)},_parseValue:function(){var t=this.element.val();return t?this.options.parse(t,this.element):null},_validate:function(t){var e=this.options,n=e.min,i=e.max;return null!=t||e.allowNull||(t=null!=this.curvalue?this.curvalue:n||i||0),null!=i&&i<t?i:null!=n&&t<n?n:t},_change:function(){var t=this,e=t._parseValue();t.options.min,t.options.max;t.selfChange||(isNaN(e)&&(e=t.curvalue),t._setValue(e,!0))},_setOption:function(t,e){S.Widget.prototype._setOption.call(this,t,e),this._procOptions()},increment:function(){this._doSpin(this.options.step)},decrement:function(){this._doSpin(-this.options.step)},showButtons:function(t){var e=this.btnContainer.stop();t?e.css("opacity",1):e.fadeTo("fast",1)},hideButtons:function(t){var e=this.btnContainer.stop();t?e.css("opacity",0):e.fadeTo("fast",0),this.buttons.removeClass(T)},_setValue:function(t,e){var n=this;n.curvalue=t=n._validate(t),n.element.val(null!=t?n.options.format(t,n.places,n.element):""),e||(n.selfChange=!0,n.element.change(),n.selfChange=!1)},value:function(t){return arguments.length?(this._setValue(t),this.element):this.curvalue},enable:function(){this.buttons.removeClass(e),this.element[0].disabled=!1,S.Widget.prototype.enable.call(this)},disable:function(){this.buttons.addClass(e).removeClass(T),this.element[0].disabled=!0,S.Widget.prototype.disable.call(this)},destroy:function(t){this.wrapper.remove(),this.element.unbind(L).css({width:this.oWidth,marginRight:this.oMargin}),S.Widget.prototype.destroy.call(this)}})}(jQuery);