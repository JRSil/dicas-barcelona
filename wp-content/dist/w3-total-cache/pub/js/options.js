function w3tc_popup(e,t,r,i){return void 0===r&&(r=800),void 0===i&&(i=600),window.open(e,t,"width="+r+",height="+i+",status=no,toolbar=no,menubar=no,scrollbars=yes")}function w3tc_input_enable(e,r){jQuery(e).each(function(){var e=jQuery(this);if(r?e.removeAttr("disabled"):e.attr("disabled","disabled"),r)e.next("[type=hidden]").remove();else{var t=e.attr("type");("radio"!=t&&"checkbox"!=t||e.is(":checked"))&&e.after(jQuery("<input />").attr({type:"hidden",name:e.attr("name")}).val(e.val()))}})}function w3tc_minify_js_file_clear(){jQuery("#js_files :visible").size()?jQuery("#js_files_empty").hide():jQuery("#js_files_empty").show()}function w3tc_minify_css_file_clear(){jQuery("#css_files :visible").size()?jQuery("#css_files_empty").hide():jQuery("#css_files_empty").show()}function w3tc_mobile_groups_clear(){jQuery("#mobile_groups li").size()?jQuery("#mobile_groups_empty").hide():jQuery("#mobile_groups_empty").show()}function w3tc_referrer_groups_clear(){jQuery("#referrer_groups li").size()?jQuery("#referrer_groups_empty").hide():jQuery("#referrer_groups_empty").show()}function w3tc_minify_js_file_add(e,t,r,i){var c=jQuery('<li><table><tr><th>&nbsp;</th><th>File URI:</th><th>Template:</th><th colspan="3">Embed Location:</th></tr><tr><td>'+(jQuery("#js_files li").size()+1)+'.</td><td><input class="js_enabled" type="text" name="js_files['+e+"]["+t+"]["+r+'][]" value="" size="70" /></td><td><select class="js_file_template js_enabled"></select></td><td><select class="js_file_location js_enabled"><option value="include">Embed in &lt;head&gt;</option><option value="include-body">Embed after &lt;body&gt;</option><option value="include-footer">Embed before &lt;/body&gt;</option></select></td><td><input class="js_file_delete js_enabled button" type="button" value="Delete" /> <input class="js_file_verify js_enabled button" type="button" value="Verify URI" /></td></tr></table></li>');c.find("input:text").val(i);var n=c.find(".js_file_template");for(var s in minify_templates[e])n.append(jQuery("<option />").val(s).html(minify_templates[e][s]));n.val(t),jQuery(c).find(".js_file_location").val(r),jQuery("#js_files").append(c).find("li:last input:first").focus(),w3tc_minify_js_file_clear()}function w3tc_minify_css_file_add(e,t,r){var i=jQuery('<li><table><tr><th>&nbsp;</th><th>File URI:</th><th colspan="2">Template:</th></tr><tr><td>'+(jQuery("#css_files li").size()+1)+'.</td><td><input class="css_enabled" type="text" name="css_files['+e+"]["+t+'][include][]" value="" size="70" /></td><td><select class="css_file_template css_enabled"></select></td><td><input class="css_file_delete css_enabled button" type="button" value="Delete" /></td><td><input class="css_file_verify css_enabled button" type="button" value="Verify URI" /></td></tr></table></li>');i.find("input:text").val(r);var c=i.find(".css_file_template");for(var n in minify_templates[e])c.append(jQuery("<option />").val(n).html(minify_templates[e][n]));c.val(t),jQuery("#css_files").append(i).find("li:last input:first").focus(),w3tc_minify_css_file_clear()}function w3tc_minify_js_theme(t){jQuery("#js_themes").val(t),jQuery("#js_files :text").each(function(){var e=jQuery(this);0!=e.attr("name").indexOf("js_files["+t+"]")?e.parents("li").hide():e.parents("li").show()}),w3tc_minify_js_file_clear()}function w3tc_minify_css_theme(t){jQuery("#css_themes").val(t),jQuery("#css_files :text").each(function(){var e=jQuery(this);0!=e.attr("name").indexOf("css_files["+t+"]")?e.parents("li").hide():e.parents("li").show()}),w3tc_minify_css_file_clear()}function w3tc_cdn_get_cnames(){var i=[];return jQuery("#cdn_cnames input[type=text]").each(function(){var e=jQuery(this).val();if(e){var t=/^\*\.(.*)$/.exec(e);if(t){i=[];for(var r=1;r<=10;r++)i.push("cdn"+r+"."+t[1]);return!1}i.push(e)}}),i}function w3tc_cdn_cnames_assign(){var e=jQuery("#cdn_cnames li"),r=e.size();1<r?e.eq(0).find(".cdn_cname_delete").show():e.eq(0).find(".cdn_cname_delete").hide(),jQuery(e).each(function(e){var t="";if(1<r)switch(e){case 0:t="(reserved for CSS)";break;case 1:t="(reserved for JS in <head>)";break;case 2:t="(reserved for JS after <body>)";break;case 3:t="(reserved for JS before </body>)"}jQuery(this).find("span").text(t)})}function w3tc_toggle(e,r){void 0===r&&(r=!0);var i="#"+e,c="."+e;jQuery(c).click(function(){var t=r;jQuery(c).each(function(){var e=jQuery(this).is(":checked");if(r&&!e||!r&&e)return t=!r,!1}),t?jQuery(i).attr("checked","checked"):jQuery(i).removeAttr("checked")}),jQuery(i).click(function(){var e=jQuery(this).is(":checked");jQuery(c).each(function(){e?jQuery(this).attr("checked","checked"):jQuery(this).removeAttr("checked")})})}function w3tc_toggle2(e,t){var r,i="#"+e,c="";for(r=0;r<t.length;r++)c+=(0<r?",":"")+"#"+t[r];jQuery(c).click(function(){var e=!0;jQuery(c).each(function(){jQuery(this).is(":checked")||(e=!1)}),e?jQuery(i).attr("checked","checked"):jQuery(i).removeAttr("checked")}),jQuery(i).click(function(){var e=jQuery(this).is(":checked");jQuery(c).each(function(){e?jQuery(this).attr("checked","checked"):jQuery(this).removeAttr("checked")})})}function w3tc_beforeupload_bind(){jQuery(window).bind("beforeunload",w3tc_beforeunload)}function w3tc_beforeupload_unbind(){jQuery(window).unbind("beforeunload",w3tc_beforeunload)}function w3tc_beforeunload(){return"Navigate away from this page without saving your changes?"}function w3tc_starts_with(e,t){return(e=(e=e.replace(/\n/g,"")).replace(/\s/g,"")).substr(0,t.length)==t}function w3tc_security_headers(){var e={browsercache_security_hsts_directive:{maxage:'The time, in seconds (as defined under the "Expires Header Lifetime" box of "Media & Other Files"), that the browser should remember that this site is only to be accessed using HTTPS. This only affects the site\'s main domain.',maxagepre:'The time, in seconds (as defined under the "Expires Header Lifetime" box of "Media & Other Files"), that the browser should remember that this site is only to be accessed using HTTPS with a request to be included in Chrome\'s HSTS preload list - a list of sites that are hardcoded into Chrome as being HTTPS only. This only affects the site\'s main domain.',maxageinc:'The time, in seconds (as defined under the "Expires Header Lifetime" box of "Media & Other Files"), that the browser should remember that this site is only to be accessed using HTTPS. This affects the site\'s subdomains as well.',maxageincpre:'The time, in seconds (as defined under the "Expires Header Lifetime" box of "Media & Other Files"), that the browser should remember that this site is only to be accessed using HTTPS with a request to be included in Chrome\'s HSTS preload list - a list of sites that are hardcoded into Chrome as being HTTPS only. This affects the site\'s subdomains as well.'},browsercache_security_xfo_directive:{same:"The page can only be displayed in a frame on the same origin as the page itself.",deny:"The page cannot be displayed in a frame, regardless of the site attempting to do so.",allow:"The page can only be displayed in a frame on the specified URL."},browsercache_security_xss_directive:{0:"Disables XSS filtering.",1:"Enables XSS filtering (usually default in browsers). If a cross-site scripting attack is detected, the browser will sanitize the page (remove the unsafe parts).",block:"Enables XSS filtering. Rather than sanitizing the page, the browser will prevent rendering of the page if an attack is detected."},browsercache_security_pkp_extra:{maxage:'The time, in seconds (as defined under the "Expires Header Lifetime" box of "Media & Other Files"), that the browser should remember that this site is only to be accessed using one of the defined keys. This only affects the site\'s main domain.',maxageinc:'The time, in seconds (as defined under the "Expires Header Lifetime" box of "Media & Other Files"), that the browser should remember that this site is only to be accessed using one of the defined keys. This affects the site\'s subdomains as well.'},browsercache_security_pkp_report_only:{0:"This instructs the browser to enforce the HPKP policy.",1:"This sets up HPKP without enforcement allowing you to use pinning to test its impact without the risk of a failed connection caused by your site being unreachable or HPKP being misconfigured."}};jQuery("#browsercache_security_hsts_directive,#browsercache_security_xfo_directive,#browsercache_security_xss_directive,#browsercache_security_pkp_extra,#browsercache_security_pkp_report_only").change(function(){jQuery("#"+jQuery(this).attr("id")+"_description").html("<i>"+e[jQuery(this).attr("id")][jQuery(this).val()]+"</i>"),"browsercache_security_xfo_directive"==jQuery(this).attr("id")&&("allow"==jQuery(this).val()?jQuery("#browsercache_security_xfo_allow").show():jQuery("#browsercache_security_xfo_allow").hide())}),jQuery("#browsercache_security_xfo_allow").length&&("allow"==jQuery("#browsercache_security_xfo_directive").val()?jQuery("#browsercache_security_xfo_allow").show():jQuery("#browsercache_security_xfo_allow").hide(),jQuery("#browsercache_security_hsts_directive,#browsercache_security_xfo_directive,#browsercache_security_xss_directive,#browsercache_security_pkp_extra,#browsercache_security_pkp_report_only").change())}function w3tc_csp_reference(){W3tc_Lightbox.open({id:"w3tc-overlay",close:"",width:890,height:660,content:'<div id="w3tc_csp"></div>'}),jQuery("div#overlay,.lightbox-content").click(function(){W3tc_Lightbox.close()})}jQuery(function(){jQuery(".w3tc_read_technical_info").click(function(){jQuery(".w3tc_technical_info").toggle()}),jQuery("#plugin_license_key_verify").click(function(){jQuery(".w3tc_license_verification").html("Checking...");var e=jQuery("#plugin_license_key").val();if(e){var t={action:"w3tc_verify_plugin_license_key",license_key:e};jQuery.get(ajaxurl,t,function(e){w3tc_starts_with(e+".","inactive.expired.")?jQuery(".w3tc_license_verification").html("The license key has expired. Please renew it."):w3tc_starts_with(e+".","active.")?jQuery(".w3tc_license_verification").html("License key is correct."):w3tc_starts_with(e+".","inactive.by_rooturi.activations_limit_not_reached.")?jQuery(".w3tc_license_verification").html("License key is correct and can be activated now."):w3tc_starts_with(e+".","inactive.by_rooturi.")?jQuery(".w3tc_license_verification").html("License key is correct but already in use on another site. See the FAQ for how to enable Pro version in development mode."):jQuery(".w3tc_license_verification").html("The license key is not valid. Please check it and try again.")}).fail(function(){jQuery(".w3tc_license_verification").html("Check failed")})}else jQuery(".w3tc_license_verification").html("Please enter an license key and try again.")}),w3tc_input_enable("#pgcache_reject_roles input[type=checkbox]",jQuery("#pgcache__reject__logged_roles:checked").size()),jQuery("#pgcache__reject__logged_roles").live("click",function(){w3tc_input_enable("#pgcache_reject_roles input[type=checkbox]",jQuery("#pgcache__reject__logged_roles:checked").size())}),jQuery("#pgcache__cache__nginx_handle_xml").is("*")&&jQuery("#pgcache__cache__nginx_handle_xml").attr("checked",jQuery("#pgcache__cache__feed").is(":checked")),jQuery("#pgcache__cache__feed").change(function(){jQuery("#pgcache__cache__nginx_handle_xml").is("*")&&jQuery("#pgcache__cache__nginx_handle_xml").attr("checked",this.checked)}),w3tc_toggle2("browsercache_last_modified",["browsercache__cssjs__last_modified","browsercache__html__last_modified","browsercache__other__last_modified"]),w3tc_toggle2("browsercache_expires",["browsercache__cssjs__expires","browsercache__html__expires","browsercache__other__expires"]),w3tc_toggle2("browsercache_cache_control",["browsercache__cssjs__cache__control","browsercache__html__cache__control","browsercache__other__cache__control"]),w3tc_toggle2("browsercache_etag",["browsercache__cssjs__etag","browsercache__html__etag","browsercache__other__etag"]),w3tc_toggle2("browsercache_w3tc",["browsercache__cssjs__w3tc","browsercache__html__w3tc","browsercache__other__w3tc"]),w3tc_toggle2("browsercache_compression",["browsercache__cssjs__compression","browsercache__html__compression","browsercache__other__compression"]),w3tc_toggle2("browsercache_replace",["browsercache__cssjs__replace","browsercache__other__replace"]),w3tc_toggle2("browsercache_querystring",["browsercache__cssjs__querystring","browsercache__other__querystring"]),w3tc_toggle2("browsercache_nocookies",["browsercache__cssjs__nocookies","browsercache__other__nocookies"]),w3tc_security_headers(),w3tc_input_enable(".html_enabled",jQuery("#minify__html__enable:checked").size()),w3tc_input_enable(".js_enabled",jQuery("#minify__js__enable:checked").size()),w3tc_input_enable(".css_enabled",jQuery("#minify__css__enable:checked").size()),w3tc_minify_js_theme(jQuery("#js_themes").val()),w3tc_minify_css_theme(jQuery("#css_themes").val()),jQuery("#minify__html__enable").click(function(){w3tc_input_enable(".html_enabled",this.checked)}),jQuery("#minify__js__enable").click(function(){w3tc_input_enable(".js_enabled",jQuery(this).is(":checked"))}),jQuery("#minify__css__enable").click(function(){w3tc_input_enable(".css_enabled",jQuery(this).is(":checked"))}),jQuery(".js_file_verify,.css_file_verify").live("click",function(){var e=jQuery(this).parents("li").find(":text").val();if(""==e)alert("Empty URI");else{w3tc_popup(/^https?:\/\//.test(e)?e:"/"+e,"file_verify")}}),jQuery(".js_file_template").live("change",function(){jQuery(this).parents("li").find(":text").attr("name","js_files["+jQuery("#js_themes").val()+"]["+jQuery(this).val()+"]["+jQuery(this).parents("li").find(".js_file_location").val()+"][]")}),jQuery(".css_file_template").live("change",function(){jQuery(this).parents("li").find(":text").attr("name","css_files["+jQuery("#css_themes").val()+"]["+jQuery(this).val()+"][include][]")}),jQuery(".js_file_location").live("change",function(){jQuery(this).parents("li").find(":text").attr("name","js_files["+jQuery("#js_themes").val()+"]["+jQuery(this).parents("li").find(".js_file_template").val()+"]["+jQuery(this).val()+"][]")}),jQuery(".js_file_delete").live("click",function(){var e=jQuery(this).parents("li");return(""==e.find("input[type=text]").val()||confirm("Are you sure you want to remove this JS file?"))&&(e.remove(),w3tc_minify_js_file_clear(),w3tc_beforeupload_bind()),!1}),jQuery(".css_file_delete").live("click",function(){var e=jQuery(this).parents("li");return(""==e.find("input[type=text]").val()||confirm("Are you sure you want to remove this CSS file?"))&&(e.remove(),w3tc_minify_css_file_clear(),w3tc_beforeupload_bind()),!1}),jQuery("#js_file_add").click(function(){w3tc_minify_js_file_add(jQuery("#js_themes").val(),"default","include","")}),jQuery("#css_file_add").click(function(){w3tc_minify_css_file_add(jQuery("#css_themes").val(),"default","")}),jQuery("#js_themes").change(function(){w3tc_minify_js_theme(jQuery(this).val())}),jQuery("#css_themes").change(function(){w3tc_minify_css_theme(jQuery(this).val())}),jQuery("#minify_form").submit(function(){var a=[],o=[],_=[],u=[],l=!1,d=[],h=[];if(jQuery("#js_files :text").each(function(){var e=jQuery(this).val(),t=jQuery(this).attr("name"),r=e+t,i="",c=/js_files\[([a-z0-9_\/]+)\]/.exec(t);if(c&&(i="["+jQuery("#js_themes option[value="+c[1]+"]").text()+"] "+e),""!=e){for(var n=0;n<a.length;n++)if(a[n]==r){l=!0;break}a.push(r);var s=e.indexOf("?");-1!=s?(/^(https?:)?\/\//.test(e)||d.push(i),e=e.substr(0,s)):/\.js$/.test(e)||_.push(i)}}),jQuery("#css_files :text").each(function(){var e=jQuery(this).val(),t=jQuery(this).attr("name"),r=e+t,i="",c=/css_files\[([a-z0-9_\/]+)\]/.exec(t);if(c&&(i="["+jQuery("#css_themes option[value="+c[1]+"]").text()+"] "+e),""!=e){for(var n=0;n<o.length;n++)if(o[n]==r){l=!0;break}o.push(r);var s=e.indexOf("?");-1!=s?(/^(https?:)?\/\//.test(e)||h.push(i),e=e.substr(0,s)):/\.css$/.test(e)||u.push(i)}}),jQuery("#js_enabled:checked").size()){if(_.length&&!confirm("The following files have invalid JS file extension:\r\n\r\n"+_.join("\r\n")+"\r\n\r\nAre you confident these files contain valid JS code?"))return!1;if(d.length)return alert("We recommend using the entire URI for files with query string (GET) variables. You entered:\r\n\r\n"+d.join("\r\n")),!1}if(jQuery("#css_enabled:checked").size()){if(u.length&&!confirm("The following files have invalid CSS file extension:\r\n\r\n"+u.join("\r\n")+"\r\n\r\nAre you confident these files contain valid CSS code?"))return!1;if(h.length)return alert("We recommend using the entire URI for files with query string (GET) variables. You entered:\r\n\r\n"+h.join("\r\n")),!1}return!l||(alert("Duplicate files have been found in your minify settings, please check your settings and re-save."),!1)}),jQuery(".w3tc-tab").click(function(){jQuery(".w3tc-tab-content").hide(),jQuery(this.rel).show()}),w3tc_input_enable("#cdn_reject_roles input[type=checkbox]",jQuery("#cdn__reject__logged_roles:checked").size()),jQuery("#cdn__reject__logged_roles").live("click",function(){w3tc_input_enable("#cdn_reject_roles input[type=checkbox]",jQuery("#cdn__reject__logged_roles:checked").size())}),jQuery("#cdn_export_library").click(function(){w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_export_library&_wpnonce="+jQuery(this).metadata().nonce,"cdn_export_library")}),jQuery("#cdn_import_library").click(function(){w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_import_library&_wpnonce="+jQuery(this).metadata().nonce,"cdn_import_library")}),jQuery("#cdn_queue").click(function(){w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_queue&_wpnonce="+jQuery(this).metadata().nonce,"cdn_queue")}),jQuery("#cdn_rename_domain").click(function(){w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_rename_domain&_wpnonce="+jQuery(this).metadata().nonce,"cdn_rename_domain")}),jQuery("#cdn_purge").click(function(){w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_purge&_wpnonce="+jQuery(this).metadata().nonce,"cdn_purge")}),jQuery(".cdn_export").click(function(){var e=jQuery(this).metadata();w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_export&cdn_export_type="+e.type+"&_wpnonce="+e.nonce,"cdn_export_"+e.type)}),jQuery("#validate_cdn_key").click(function(){var e=jQuery(this).metadata();w3tc_validate_cdn_key_result(e.type,e.nonce)}),jQuery("#use_poll_zone").click(function(){var e=jQuery(this).metadata();w3tc_use_poll_zone(e.type,e.nonce)}),jQuery("#cdn_test").click(function(){var e=jQuery(this).metadata(),t=w3tc_cdn_get_cnames(),r={w3tc_cdn_test:1,_wpnonce:e.nonce};switch(e.type){case"ftp":jQuery.extend(r,{engine:"ftp","config[host]":jQuery("#cdn_ftp_host").val(),"config[type]":jQuery("#cdn_ftp_type").val(),"config[user]":jQuery("#cdn_ftp_user").val(),"config[path]":jQuery("#cdn_ftp_path").val(),"config[pass]":jQuery("#cdn_ftp_pass").val(),"config[pasv]":jQuery("#cdn_ftp_pasv:checked").size()}),t.length&&(r["config[domain][]"]=t);break;case"s3":jQuery.extend(r,{engine:"s3","config[key]":jQuery("#cdn_s3_key").val(),"config[secret]":jQuery("#cdn_s3_secret").val(),"config[bucket]":jQuery("#cdn_s3_bucket").val(),"config[bucket_location]":jQuery("#cdn_s3_bucket_location").val()}),t.length&&(r["config[cname][]"]=t);break;case"cf":jQuery.extend(r,{engine:"cf","config[key]":jQuery("#cdn_cf_key").val(),"config[secret]":jQuery("#cdn_cf_secret").val(),"config[bucket]":jQuery("#cdn_cf_bucket").val(),"config[bucket_location]":jQuery("#cdn_cf_bucket_location").val(),"config[id]":jQuery("#cdn_cf_id").val()}),t.length&&(r["config[cname][]"]=t);break;case"cf2":jQuery.extend(r,{engine:"cf2","config[key]":jQuery("#cdn_cf2_key").val(),"config[secret]":jQuery("#cdn_cf2_secret").val(),"config[origin]":jQuery("#cdn_cf2_origin").val(),"config[id]":jQuery("#cdn_cf2_id").val()}),t.length&&(r["config[cname][]"]=t);break;case"rscf":jQuery.extend(r,{engine:"rscf","config[user]":jQuery("#cdn_rscf_user").val(),"config[key]":jQuery("#cdn_rscf_key").val(),"config[location]":jQuery("#cdn_rscf_location").val(),"config[container]":jQuery("#cdn_rscf_container").val(),"config[id]":jQuery("#cdn_rscf_id").val()}),t.length&&(r["config[cname][]"]=t);break;case"azure":jQuery.extend(r,{engine:"azure","config[user]":jQuery("#cdn_azure_user").val(),"config[key]":jQuery("#cdn_azure_key").val(),"config[container]":jQuery("#cdn_azure_container").val()}),t.length&&(r["config[cname][]"]=t);break;case"mirror":jQuery.extend(r,{engine:"mirror"}),t.length&&(r["config[domain][]"]=t);break;case"cotendo":var i=[],c=jQuery("#cdn_cotendo_zones").val();c&&(i=c.split(/[\r\n,;]+/)),jQuery.extend(r,{engine:"cotendo","config[username]":jQuery("#cdn_cotendo_username").val(),"config[password]":jQuery("#cdn_cotendo_password").val()}),i.length&&(r["config[zones][]"]=i),t.length&&(r["config[domain][]"]=t);break;case"akamai":var n=[],s=jQuery("#cdn_akamai_email_notification").val();s&&(n=s.split(/[\r\n,;]+/)),jQuery.extend(r,{engine:"akamai","config[username]":jQuery("#cdn_akamai_username").val(),"config[password]":jQuery("#cdn_akamai_password").val(),"config[zone]":jQuery("#cdn_akamai_zone").val()}),n.length&&(r["config[email_notification][]"]=n),t.length&&(r["config[domain][]"]=t);break;case"edgecast":jQuery.extend(r,{engine:"edgecast","config[account]":jQuery("#cdn_edgecast_account").val(),"config[token]":jQuery("#cdn_edgecast_token").val()}),t.length&&(r["config[domain][]"]=t);break;case"att":jQuery.extend(r,{engine:"att","config[account]":jQuery("#cdn_att_account").val(),"config[token]":jQuery("#cdn_att_token").val()}),t.length&&(r["config[domain][]"]=t);break;default:jQuery.extend(r,{engine:e.type})}var a=jQuery("#cdn_test_status");a.removeClass("w3tc-error"),a.removeClass("w3tc-success"),a.addClass("w3tc-process");var o=jQuery("#cdn_create_container_status");o.removeClass("w3tc-error"),o.removeClass("w3tc-success"),o.html(""),a.html("Testing..."),jQuery.post("admin.php?page=w3tc_dashboard",r,function(e){a.addClass(e.result?"w3tc-success":"w3tc-error"),a.html(e.error)},"json").fail(function(){a.addClass("w3tc-error"),a.html("Test failed")})}),jQuery("#cdn_create_container").live("click",function(){var e=jQuery(this).metadata(),t=w3tc_cdn_get_cnames(),r=null,i={w3tc_cdn_create_container:1,_wpnonce:e.nonce};switch(e.type){case"s3":jQuery.extend(i,{engine:"s3","config[key]":jQuery("#cdn_s3_key").val(),"config[secret]":jQuery("#cdn_s3_secret").val(),"config[bucket]":jQuery("#cdn_s3_bucket").val(),"config[bucket_location]":jQuery("#cdn_s3_bucket_location").val()}),t.length&&(i["config[cname][]"]=t);break;case"cf":r=jQuery("#cdn_cf_id"),jQuery.extend(i,{engine:"cf","config[key]":jQuery("#cdn_cf_key").val(),"config[secret]":jQuery("#cdn_cf_secret").val(),"config[bucket]":jQuery("#cdn_cf_bucket").val(),"config[bucket_location]":jQuery("#cdn_cf_bucket_location").val()}),t.length&&(i["config[cname][]"]=t);break;case"cf2":r=jQuery("#cdn_cf2_id"),jQuery.extend(i,{engine:"cf2","config[key]":jQuery("#cdn_cf2_key").val(),"config[secret]":jQuery("#cdn_cf2_secret").val(),"config[origin]":jQuery("#cdn_cf2_origin").val(),"config[bucket_location]":jQuery("#cdn_cf2_bucket_location").val()}),t.length&&(i["config[cname][]"]=t);break;case"rscf":r=jQuery("#cdn_cnames input[type=text]:first"),jQuery.extend(i,{engine:"rscf","config[user]":jQuery("#cdn_rscf_user").val(),"config[key]":jQuery("#cdn_rscf_key").val(),"config[location]":jQuery("#cdn_rscf_location").val(),"config[container]":jQuery("#cdn_rscf_container").val()}),t.length&&(i["config[cname][]"]=t);break;case"azure":jQuery.extend(i,{engine:"azure","config[user]":jQuery("#cdn_azure_user").val(),"config[key]":jQuery("#cdn_azure_key").val(),"config[container]":jQuery("#cdn_azure_container").val()}),t.length&&(i["config[cname][]"]=t)}var c=jQuery("#cdn_create_container_status");c.removeClass("w3tc-error"),c.removeClass("w3tc-success"),c.addClass("w3tc-process");var n=jQuery("#cdn_test_status");n.removeClass("w3tc-error"),n.removeClass("w3tc-success"),n.html(""),c.html("Creating..."),jQuery.post("admin.php?page=w3tc_dashboard",i,function(e){c.addClass(e.result?"w3tc-success":"w3tc-error"),c.html(e.error),r&&r.size()&&e.container_id&&r.val(e.container_id)},"json").fail(function(){c.addClass("w3tc-error"),c.html("failed")})}),jQuery("#memcached_test").click(function(){var t=jQuery("#memcached_test_status");t.removeClass("w3tc-error"),t.removeClass("w3tc-success"),t.addClass("w3tc-process"),t.html("Testing..."),jQuery.post("admin.php?page=w3tc_dashboard",{w3tc_test_memcached:1,servers:jQuery("#memcached_servers").val(),_wpnonce:jQuery(this).metadata().nonce},function(e){t.addClass(e.result?"w3tc-success":"w3tc-error"),t.html(e.error)},"json").fail(function(){t.addClass("w3tc-error"),t.html("Request failed")})}),jQuery(".w3tc_common_redis_test").click(function(){var t=jQuery(".w3tc_common_redis_test_result");t.removeClass("w3tc-error"),t.removeClass("w3tc-success"),t.addClass("w3tc-process"),t.html("Testing..."),jQuery.post("admin.php?page=w3tc_dashboard",{w3tc_test_redis:1,servers:jQuery("#redis_servers").val(),dbid:jQuery("#redis_dbid").val(),password:jQuery("#redis_password").val(),_wpnonce:jQuery(this).metadata().nonce},function(e){t.addClass(e.result?"w3tc-success":"w3tc-error"),t.html(e.error)},"json").fail(function(){t.addClass("w3tc-error"),t.html("Request failed")})}),jQuery(".minifier_test").click(function(){var e=jQuery(this),t=e.metadata(),r={w3tc_test_minifier:1,_wpnonce:t.nonce};switch(t.type){case"yuijs":jQuery.extend(r,{engine:"yuijs",path_java:jQuery("#minify__yuijs__path__java").val(),path_jar:jQuery("#minify__yuijs__path__jar").val()});break;case"yuicss":jQuery.extend(r,{engine:"yuicss",path_java:jQuery("#minify__yuicss__path__java").val(),path_jar:jQuery("#minify__yuicss__path__jar").val()});break;case"ccjs":jQuery.extend(r,{engine:"ccjs",path_java:jQuery("#minify__ccjs__path__java").val(),path_jar:jQuery("#minify__ccjs__path__jar").val()});break;case"googleccjs":jQuery.extend(r,{engine:"googleccjs"})}var i=e.next();i.removeClass("w3tc-error"),i.removeClass("w3tc-success"),i.addClass("w3tc-process"),i.html("Testing..."),jQuery.post("admin.php?page=w3tc_dashboard",r,function(e){i.addClass(e.result?"w3tc-success":"w3tc-error"),i.html(e.error)},"json")}),jQuery("body").on("click","#cdn_cname_add",function(){jQuery("#cdn_cnames").append('<li><input type="text" name="cdn_cnames[]" value="" size="60" /> <input class="button cdn_cname_delete" type="button" value="Delete" /> <span></span></li>'),w3tc_cdn_cnames_assign(),jQuery(this).trigger("size_change")}),jQuery(".cdn_cname_delete").live("click",function(){var e=jQuery(this).parent();(""==e.find("input[type=text]").val()||confirm("Are you sure you want to remove this CNAME?"))&&(e.remove(),w3tc_cdn_cnames_assign(),w3tc_beforeupload_bind())}),jQuery("#cdn_form").submit(function(){var t=[],r=!0;return jQuery("#cdn_cnames input[type=text]").each(function(){var e=jQuery(this).val();if(e){if(-1!=jQuery.inArray(e,t))return alert('CNAME "'+e+'" already exists.'),r=!1;t.push(e)}}),r}),jQuery("#mobile_form").submit(function(){var o=!1;if(jQuery("#mobile_groups li").each(function(){if(jQuery(this).find(":checked").size()){var c=jQuery(this).find(".mobile_group").text(),n=jQuery(this).find(":selected").val(),s=jQuery(this).find("input[type=text]").val(),a=jQuery.trim(jQuery(this).find("textarea").val()).split("\n");if(jQuery("#mobile_groups li").each(function(){if(jQuery(this).find(":checked").size()){var r=jQuery(this).find(".mobile_group").text();if(r!=c){var e=jQuery(this).find(":selected").val(),t=jQuery(this).find("input[type=text]").val(),i=jQuery.trim(jQuery(this).find("textarea").val()).split("\n");if(""==t&&""==s&&""!=e&&e==n)return alert('Duplicate theme "'+e+'" found in the group "'+c+'".'),!(o=!0);if(""!=t&&t==s)return alert('Duplicate redirect "'+t+'" found in the group "'+c+'".'),!(o=!0);jQuery.each(i,function(e,t){if(-1!=jQuery.inArray(t,a))return alert('Duplicate stem "'+t+'" found in the group "'+r+'".'),!(o=!0)})}}}),o)return!1}}),o)return!1}),jQuery("#mobile_add").click(function(){var e=prompt('Enter group name (only "0-9", "a-z", "_" symbols are allowed).');if(null!==e)if(e=(e=(e=(e=e.toLowerCase()).replace(/[^0-9a-z_]+/g,"_")).replace(/^_+/,"")).replace(/_+$/,"")){var t=!1;if(jQuery(".mobile_group").each(function(){if(jQuery(this).html()==e)return alert("Group already exists!"),!(t=!0)}),!t){var r=jQuery('<li id="mobile_group_'+e+'"><table class="form-table"><tr><th>Group name:</th><td><span class="mobile_group_number">'+(jQuery("#mobile_groups li").size()+1)+'.</span> <span class="mobile_group">'+e+'</span> <input type="button" class="button mobile_delete" value="Delete group" /></td></tr><tr><th><label for="mobile_groups_'+e+'_enabled">Enabled:</label></th><td><input type="hidden" name="mobile_groups['+e+'][enabled]" value="0" /><input id="mobile_groups_'+e+'_enabled" type="checkbox" name="mobile_groups['+e+'][enabled]" value="1" checked="checked" /></td></tr><tr><th><label for="mobile_groups_'+e+'_theme">Theme:</label></th><td><select id="mobile_groups_'+e+'_theme" name="mobile_groups['+e+'][theme]"><option value="">-- Pass-through --</option></select><br /><span class="description">Assign this group of user agents to a specific them. Leaving this option "Active Theme" allows any plugins you have (e.g. mobile plugins) to properly handle requests for these user agents. If the "redirect users to" field is not empty, this setting is ignored.</span></td></tr><tr><th><label for="mobile_groups_'+e+'_redirect">Redirect users to:</label></th><td><input id="mobile_groups_'+e+'_redirect" type="text" name="mobile_groups['+e+'][redirect]" value="" size="60" /><br /><span class="description">A 302 redirect is used to send this group of users to another hostname (domain); recommended if a 3rd party service provides a mobile version of your site.</span></td></tr><tr><th><label for="mobile_groups_'+e+'_agents">User agents:</label></th><td><textarea id="mobile_groups_'+e+'_agents" name="mobile_groups['+e+'][agents]" rows="10" cols="50"></textarea><br /><span class="description">Specify the user agents for this group.</span></td></tr></table></li>'),i=r.find("select");jQuery.each(mobile_themes,function(e,t){i.append(jQuery("<option />").val(e).html(t))}),jQuery("#mobile_groups").append(r),w3tc_mobile_groups_clear(),window.location.hash="#mobile_group_"+e,r.find("textarea").focus()}}else alert("Empty group name!")}),jQuery(".mobile_delete").live("click",function(){confirm("Are you sure want to delete this group?")&&(jQuery(this).parents("#mobile_groups li").remove(),w3tc_mobile_groups_clear(),w3tc_beforeupload_bind())}),w3tc_mobile_groups_clear(),jQuery("#referrer_form").submit(function(){var o=!1;if(jQuery("#referrer_groups li").each(function(){if(jQuery(this).find(":checked").size()){var c=jQuery(this).find(".referrer_group").text(),n=jQuery(this).find(":selected").val(),s=jQuery(this).find("input[type=text]").val(),a=jQuery.trim(jQuery(this).find("textarea").val()).split("\n");if(jQuery("#referrer_groups li").each(function(){if(jQuery(this).find(":checked").size()){var r=jQuery(this).find(".referrer_group").text();if(r!=c){var e=jQuery(this).find(":selected").val(),t=jQuery(this).find("input[type=text]").val(),i=jQuery.trim(jQuery(this).find("textarea").val()).split("\n");if(""==t&&""==s&&""!=e&&e==n)return alert('Duplicate theme "'+e+'" found in the group "'+c+'".'),!(o=!0);if(""!=t&&t==s)return alert('Duplicate redirect "'+t+'" found in the group "'+c+'".'),!(o=!0);jQuery.each(i,function(e,t){if(-1!=jQuery.inArray(t,a))return alert('Duplicate stem "'+t+'" found in the group "'+r+'".'),!(o=!0)})}}}),o)return!1}}),o)return!1}),jQuery("#referrer_add").click(function(){var e=prompt('Enter group name (only "0-9", "a-z", "_" symbols are allowed).');if(null!==e)if(e=(e=(e=(e=e.toLowerCase()).replace(/[^0-9a-z_]+/g,"_")).replace(/^_+/,"")).replace(/_+$/,"")){var t=!1;if(jQuery(".referrer_group").each(function(){if(jQuery(this).html()==e)return alert("Group already exists!"),!(t=!0)}),!t){var r=jQuery('<li id="referrer_group_'+e+'"><table class="form-table"><tr><th>Group name:</th><td><span class="referrer_group_number">'+(jQuery("#referrer_groups li").size()+1)+'.</span> <span class="referrer_group">'+e+'</span> <input type="button" class="button referrer_delete" value="Delete group" /></td></tr><tr><th><label for="referrer_groups_'+e+'_enabled">Enabled:</label></th><td><input type="hidden" name="referrer_groups['+e+'][enabled]" value="0" /><input id="referrer_groups_'+e+'_enabled" type="checkbox" name="referrer_groups['+e+'][enabled]" value="1" checked="checked" /></td></tr><tr><th><label for="referrer_groups_'+e+'_theme">Theme:</label></th><td><select id="referrer_groups_'+e+'_theme" name="referrer_groups['+e+'][theme]"><option value="">-- Pass-through --</option></select><br /><span class="description">Assign this group of referrers to a specific them. Leaving this option "Active Theme" allows any plugins you have (e.g. referrer plugins) to properly handle requests for these referrers. If the "redirect users to" field is not empty, this setting is ignored.</span></td></tr><tr><th><label for="referrer_groups_'+e+'_redirect">Redirect users to:</label></th><td><input id="referrer_groups_'+e+'_redirect" type="text" name="referrer_groups['+e+'][redirect]" value="" size="60" /><br /><span class="description">A 302 redirect is used to send this group of users to another hostname (domain); recommended if a 3rd party service provides a referrer version of your site.</span></td></tr><tr><th><label for="referrer_groups_'+e+'_referrers">Referrers:</label></th><td><textarea id="referrer_groups_'+e+'_referrers" name="referrer_groups['+e+'][referrers]" rows="10" cols="50"></textarea><br /><span class="description">Specify the referrers for this group.</span></td></tr></table></li>'),i=r.find("select");jQuery.each(referrer_themes,function(e,t){i.append(jQuery("<option />").val(e).html(t))}),jQuery("#referrer_groups").append(r),w3tc_referrer_groups_clear(),window.location.hash="#referrer_group_"+e,r.find("textarea").focus()}}else alert("Empty group name!")}),jQuery(".referrer_delete").live("click",function(){confirm("Are you sure want to delete this group?")&&(jQuery(this).parents("#referrer_groups li").remove(),w3tc_referrer_groups_clear(),w3tc_beforeupload_bind())}),w3tc_referrer_groups_clear(),jQuery.ui&&jQuery.ui.sortable&&(jQuery("#js_files,#css_files").sortable({axis:"y",stop:function(){jQuery(this).find("li").each(function(e){jQuery(this).find("td:eq(0)").html(e+1+".")})}}),jQuery("#cdn_cnames").sortable({axis:"y",stop:w3tc_cdn_cnames_assign}),jQuery("#mobile_groups").sortable({axis:"y",stop:function(){jQuery("#mobile_groups").find(".mobile_group_number").each(function(e){jQuery(this).html(e+1+".")})}}),jQuery("#referrer_groups").sortable({axis:"y",stop:function(){jQuery("#referrer_groups").find(".referrer_group_number").each(function(e){jQuery(this).html(e+1+".")})}})),jQuery(".w3tc-show-rules").click(function(){var e=jQuery(this),t=e.parent().find(".w3tc-rules");t.is(":visible")?(t.css("display","none"),e.val("view code")):(t.css("display","block"),e.val("hide code"))}),jQuery(".w3tc-show-required-changes").click(function(){var e=jQuery(this),t=jQuery(".w3tc-required-changes");t.is(":visible")?(t.css("display","none"),e.val("View required changes")):(t.css("display","block"),e.val("Hide required changes"))}),jQuery(".w3tc-show-ftp-form").click(function(){var e=jQuery(this),t=jQuery(".w3tc-ftp-form");t.is(":visible")?(t.css("display","none"),e.val("Update via FTP")):(t.css("display","block"),e.val("Cancel FTP Update"))}),jQuery(".w3tc-show-technical-info").click(function(){var e=jQuery(this),t=jQuery(".w3tc-technical-info");t.is(":visible")?(t.css("display","none"),e.val("Technical Information")):(t.css("display","block"),e.val("Hide technical information"))}),jQuery("#ftp_upload_form").find("input").each(function(){jQuery(this).addClass("w3tc-ignore-change")}),jQuery(".w3tc_link_more").click(function(){var e=jQuery(this).metadata().for_class;jQuery("."+e).slideToggle()}),jQuery("#w3tc input,#w3tc select,#w3tc textarea").live("change",function(){var e=!1;jQuery(this).parents().andSelf().each(function(){if(jQuery(this).hasClass("w3tc-ignore-change")||jQuery(this).hasClass("lightbox"))return!(e=!0)}),e||w3tc_beforeupload_bind()}),jQuery("body").on("click",".w3tc-button-save",w3tc_beforeupload_unbind),jQuery(".contextual-help-tabs ul li a").click(function(){var e=jQuery(this).attr("aria-controls");t(jQuery("#"+e+" .w3tchelp_content"))}),jQuery("#contextual-help-link").click(function(){t(jQuery(".w3tchelp_content").first())});var r={};function t(t){var e=t.attr("data-section");r[e]||(t.html('<div class="w3tchelp_loading_outer"><div class="w3tc-loading w3tchelp_loading_inner"></div></div>'),r[e]=!0,jQuery.getJSON(ajaxurl,{action:"w3tc_ajax",_wpnonce:w3tc_nonce,w3tc_action:"faq",section:e},function(e){t.html(e.content)}).fail(function(){t.html("Failed to obtain data")}))}jQuery(".w3tc_extensions_manage_input_checkall").click(function(e){var t=jQuery(this).is(":checked");jQuery(".w3tc_extensions_manage_input_checkall").prop("checked",t),jQuery(".w3tc_extensions_input_active").each(function(e){jQuery(this).is(":disabled")||jQuery(this).prop("checked",t)})}),"undefined"!=typeof ga&&(jQuery(".w3tc_error").each(function(){var e=jQuery(this).attr("id"),t=jQuery(this).text();e&&ga("send","event","w3tc_error",e,t)}),jQuery(".w3tc_note").each(function(){var e=jQuery(this).attr("id"),t=jQuery(this).text();e&&ga("send","event","w3tc_note",e,t)}),jQuery("body").on("click","a",function(){var e=jQuery(this).attr("href");e&&ga("send","event","anchor","click",e,{useBeacon:!0})}),jQuery("body").on("click",'input[type="button"]',function(){var e=jQuery(this).attr("name");e&&ga("send","event","button","click",e,{useBeacon:!0})}),jQuery("body").on("click",'input[type="submit"]',function(){var e=jQuery(this).attr("name"),t=jQuery(this).attr("id");t||(t=e),e&&ga("send","event","button",t,e,{useBeacon:!0})}),jQuery("body").on("click",'input[type="checkbox"]',function(){var e=jQuery(this).attr("name"),t=jQuery(this).is(":checked")?"check":"uncheck";e&&ga("send","event","checkbox",t,e)}),jQuery("body").on("change","select",function(){var e=jQuery(this).attr("name"),t=jQuery(this).val();e&&t&&ga("send","event","select",t,e)}))});