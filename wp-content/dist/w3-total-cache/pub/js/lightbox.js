var W3tc_Lightbox={window:jQuery(window),container:null,options:null,create:function(){var i=this;this.container=jQuery('<div class="'+this.options.id+'"><div class="lightbox-close">'+this.options.close+'</div><div id="w3tc_lightbox_content" class="lightbox-content"></div></div>').css({top:0,left:0,width:0,height:0,position:"fixed","z-index":9991,display:"none"}),jQuery("#w3tc").append(this.container),i.resize(),this.window.resize(function(){i.resize()}),this.window.scroll(function(){i.resize()}),this.container.find(".lightbox-close").click(function(){i.close()}),jQuery(document).keyup(function(t){27==t.keyCode&&i.close()})},open:function(t){if(this.options=jQuery.extend({id:"lightbox",close:"Close window",width:0,height:0,maxWidth:0,maxHeight:0,minWidth:0,minHeight:0,widthPercent:.6,heightPercent:.8,content:null,url:null,callback:null},t),this.create(),this.resize(),this.options.content)this.content(this.options.content);else if(this.options.url){var i;if(this.load(this.options.url,this.options.callback),"undefined"!=typeof ga)if((i=this.options.url.match(/w3tc_action=([^&]+)/))&&i[1])ga("send","pageview","overlays/"+i[1]);else(i=this.options.url.match(/&(w3tc_[^&]+)&/))&&i[1]&&ga("send","pageview","overlays/"+i[1])}W3tc_Overlay.show(),this.container.show()},close:function(){this.options.onClose&&this.options.onClose(),this.container.remove(),W3tc_Overlay.hide()},resize:function(){var t=this.options.width?this.options.width:this.window.width()*this.options.widthPercent,i=this.options.height?this.options.height:this.window.height()*this.options.heightPercent;this.options.maxWidth||(this.options.maxWidth=this.window.width()),this.options.maxHeight||(this.options.maxHeight=this.window.height()),this.options.maxWidth&&t>this.options.maxWidth?t=this.options.maxWidth:t<this.options.minWidth&&(t=this.options.minWidth),this.options.maxHeight&&i>this.options.maxHeight?i=this.options.maxHeight:i<this.options.minHeight&&(i=this.options.minHeight),this.container.css({width:t,height:i}),this.container.css({top:0<=this.window.height()/2-this.container.outerHeight()/2?this.window.height()/2-this.container.outerHeight()/2:0,left:0<=this.window.width()/2-this.container.outerWidth()/2?this.window.width()/2-this.container.outerWidth()/2:0}),jQuery(".lightbox-content",this.container).css({width:t,height:i})},load:function(t,i){this.content(""),this.loading(!0);var e=this;jQuery.get(t,{},function(t){if(e.loading(!1),"Location "===t.substr(0,9))return w3tc_beforeupload_unbind(),void(window.location=t.substr(9));e.content(t),i&&i.call(this,e)})},load_form:function(t,i,e){data={};jQuery(i).find("input").each(function(t){var i=jQuery(this).attr("name"),e=jQuery(this).attr("type");("radio"!=e&&"checkbox"!=e||jQuery(this).prop("checked"))&&i&&(data[i]=jQuery(this).val())});this.content(""),this.loading(!0);var n=this;jQuery.post(t,data,function(t){if(n.loading(!1),"Location "===t.substr(0,9))return w3tc_beforeupload_unbind(),void(window.location=t.substr(9));n.content(t),e&&e.call(this,n)})},content:function(t){return this.container.find(".lightbox-content").html(t)},width:function(t){return void 0===t?this.container.width():(this.container.css("width",t),this.resize())},height:function(t){return void 0===t?this.container.height():(this.container.css("height",t),this.resize())},loading:function(t){t?this.container.find(".lightbox-content").addClass("lightbox-loader"):this.container.find(".lightbox-content").removeClass("lightbox-loader")}},W3tc_Overlay={window:jQuery(window),container:null,create:function(){var t=this;this.container=jQuery('<div id="overlay" />').css({top:0,left:0,width:0,height:0,position:"fixed","z-index":9990,display:"none",opacity:.6}),jQuery("#w3tc").append(this.container),this.window.resize(function(){t.resize()}),this.window.scroll(function(){t.resize()})},show:function(){this.create(),this.resize(),this.container.show()},hide:function(){this.container.remove()},resize:function(){this.container.css({width:this.window.width(),height:this.window.height()})}},w3tc_minify_recommendations_checked={};function w3tc_lightbox_minify_recommendations(t){W3tc_Lightbox.open({width:1e3,url:"admin.php?page=w3tc_minify&w3tc_test_minify_recommendations&_wpnonce="+t,callback:function(i){var e=jQuery("#recom_theme").val();jQuery.ui&&jQuery.ui.sortable&&jQuery("#recom_js_files,#recom_css_files").sortable({axis:"y",stop:function(){jQuery(this).find("li").each(function(t){jQuery(this).find("td:eq(1)").html(t+1+".")})}}),void 0!==w3tc_minify_recommendations_checked[e]&&jQuery("#recom_js_files :text,#recom_css_files :text").each(function(){var t=jQuery(this).parents("li").find("[name=recom_js_template]").val()+":"+jQuery(this).val();if(void 0!==w3tc_minify_recommendations_checked[e][t]){var i=jQuery(this).parents("li").find(":checkbox");w3tc_minify_recommendations_checked[e][t]?i.attr("checked","checked"):i.removeAttr("checked")}}),jQuery("#recom_theme").change(function(){jQuery("#recom_js_files :checkbox,#recom_css_files :checkbox").each(function(){var t=jQuery(this).parents("li"),i=t.find("[name=recom_js_template]").val()+":"+t.find(":text").val();void 0===w3tc_minify_recommendations_checked[e]&&(w3tc_minify_recommendations_checked[e]={}),w3tc_minify_recommendations_checked[e][i]=jQuery(this).is(":checked")}),i.load("admin.php?page=w3tc_minify&w3tc_test_minify_recommendations&theme_key="+jQuery(this).val()+"&_wpnonce="+t,i.options.callback)}),jQuery("#recom_js_check").click(function(){return jQuery("#recom_js_files :checkbox:checked").size()?jQuery("#recom_js_files :checkbox").removeAttr("checked"):jQuery("#recom_js_files :checkbox").attr("checked","checked"),!1}),jQuery("#recom_css_check").click(function(){return jQuery("#recom_css_files :checkbox:checked").size()?jQuery("#recom_css_files :checkbox").removeAttr("checked"):jQuery("#recom_css_files :checkbox").attr("checked","checked"),!1}),jQuery(".recom_apply",i.container).click(function(){var t=jQuery("#recom_theme").val();jQuery("#js_files li").each(function(){-1!=jQuery(this).find(":text").attr("name").indexOf("js_files["+t+"]")&&jQuery(this).remove()}),jQuery("#css_files li").each(function(){-1!=jQuery(this).find(":text").attr("name").indexOf("css_files["+t+"]")&&jQuery(this).remove()}),jQuery("#recom_js_files li").each(function(){jQuery(this).find(":checkbox:checked").size()&&w3tc_minify_js_file_add(t,jQuery(this).find("[name=recom_js_template]").val(),jQuery(this).find("[name=recom_js_location]").val(),jQuery(this).find("[name=recom_js_file]").val())}),jQuery("#recom_css_files li").each(function(){jQuery(this).find(":checkbox:checked").size()&&w3tc_minify_css_file_add(t,jQuery(this).find("[name=recom_css_template]").val(),jQuery(this).find("[name=recom_css_file]").val())}),w3tc_minify_js_theme(t),w3tc_minify_css_theme(t),w3tc_input_enable(".js_enabled",jQuery("#minify_js_enable:checked").size()),w3tc_input_enable(".css_enabled",jQuery("#minify_css_enable:checked").size()),i.close()})}})}function w3tc_lightbox_self_test(t){W3tc_Lightbox.open({width:800,minHeight:300,url:"admin.php?page=w3tc_dashboard&w3tc_test_self&_wpnonce="+w3tc_nonce,callback:function(t){jQuery(".button-primary",t.container).click(function(){t.close()})}})}function w3tc_lightbox_upgrade(i){W3tc_Lightbox.open({id:"w3tc-overlay",close:"",width:800,height:350,url:"admin.php?page=w3tc_dashboard&w3tc_licensing_upgrade&_wpnonce="+i,callback:function(t){t.options.height=jQuery("#w3tc-upgrade").height()-57,jQuery(".button-primary",t.container).click(function(){t.close()}),jQuery("#w3tc-purchase",t.container).click(function(){t.close(),w3tc_lightbox_buy_plugin(i)}),t.resize()}})}function w3tc_lightbox_buy_plugin(c){W3tc_Lightbox.open({width:800,minHeight:350,maxWidth:jQuery(window).width()-40,maxHeight:jQuery(window).height()-40,url:"admin.php?page=w3tc_dashboard&w3tc_licensing_buy_plugin&_wpnonce="+c,callback:function(n){var t=function(t){if(".w3-edge.com"===t.origin.substr(t.origin.length-12)){var i=t.data.split(" ");if("license"===i[0])w3tc_lightbox_save_licence_key(function(){n.close()});else if("v2_license"===i[0]){var e=document.getElementById("buy_frame");e.contentWindow&&e.contentWindow.postMessage&&e.contentWindow.postMessage("v2_license_accepted","*"),n.options.onClose=function(){window.location=window.location+"&refresh"},w3tc_lightbox_save_licence_key(i[1],c,function(){jQuery("#buy_frame").attr("src",i[3])})}}};window.addEventListener?addEventListener("message",t,!1):attachEvent&&attachEvent("onmessage",t),jQuery(".button-primary",n.container).click(function(){n.close()})}})}function w3tc_lightbox_save_licence_key(t,i,e){jQuery("#plugin_license_key").val(t);var n={w3tc_default_save_licence_key:1,license_key:t,_wpnonce:i};jQuery.post("admin.php?page=w3tc_dashboard",n,function(t){e()},"json").fail(e)}function w3tc_lightbox_cdn_s3_bucket_location(t,i){W3tc_Lightbox.open({width:500,height:130,url:"admin.php?page=w3tc_dashboard&w3tc_cdn_s3_bucket_location&type="+t+"&_wpnonce="+i,callback:function(t){jQuery(".button",t.container).click(function(){t.close()})}})}jQuery(function(){jQuery(".button-minify-recommendations").click(function(){return w3tc_lightbox_minify_recommendations(jQuery(this).metadata().nonce),!1}),jQuery(".button-self-test").click(function(){return w3tc_lightbox_self_test(jQuery(this).metadata().nonce),!1}),jQuery(".button-buy-plugin").click(function(){return w3tc_lightbox_upgrade(w3tc_nonce),jQuery("#w3tc-license-instruction").show(),!1}),jQuery(".button-cdn-s3-bucket-location,.button-cdn-cf-bucket-location").click(function(){var t="",i=jQuery(this).metadata().nonce;return jQuery(this).hasClass("cdn_s3")?t="s3":jQuery(this).hasClass("cdn_cf")&&(t="cf"),w3tc_lightbox_cdn_s3_bucket_location(t,i),!1}),jQuery("body").on("click",".w3tc_lightbox_close",function(){W3tc_Lightbox.close()})});